#!/usr/bin/env zsh

# Install command-line tools using Homebrew

taps=(
  homebrew/boneyard
  homebrew/core
  homebrew/dupes
  homebrew/python
  homebrew/science
  homebrew/versions
  caskroom/versions
  beeftornado/rmtree
)

# Donâ€™t forget to add `$(brew --prefix coreutils)/libexec/gnubin` to `$PATH`.
packages=(
  autoconf
  automake
  bash
  binutils
  brew-rmtree
  cmake
  coreutils
  cscope
  ctags
  diffutils
  doxygen
  "ed --with-default-names"
  file-formula
  "findutils --with-default-names"
  gawk
  "gcc --without-multilib" #disable multilib for OpenMP support
  gdb
  git
  "gnu-indent --with-default-names"
  "gnu-sed --with-default-names"
  "gnu-tar --with-default-names"
  "gnu-which --with-default-names"
  "gnutls --with-default-names"
  gpatch
  gpg
  "graphviz --with-librsvg --with-x11"
  "grep --default-names"
  gzip
  hub
  "imagemagick --with-librsvg --with-x11"
  less
  make
  moreutils
  "mpich --cc=gcc-6 --build-from-source"
  openssh
  perl
  python
  python3
  reattach-to-user-namespace
  ruby
  rsync
  svn
  swig
  the_silver_searcher
  tree
  tmux
  "vim --with-override-system-vi --with-lua --with-luajit --with-tcl"
  unrar
  unzip
  watch
  "wdiff --with-gettext"
  "wget --enable-iri"
  zmq
  zsh
  zsh-completions
  # Python packages, installed last for dependencies
  "numpy --with-python3"
  "scipy --with-python3"
  "matplotlib --with-cairo --with-ghostscript --with-python3 --with-tex"
  "pyqt5 --with-python"
)

# Install GUI apps
cask_packages=(
  alfred
  cuda
  disk-inventory-x
  dropbox
  evernote
  flux
  go2shell
  google-chrome
  google-drive
  gopro-studio
  iterm2
  jaksta
  java
  jdownloader
  keepassx
  logitech-myharmony
  mactex
  mp4tools
  music-manager
  paraview
  papers
  skype
  slack
  sourcetree
  spectacle
  spotify
  steam
  synergy
  teamviewer
  virtualbox
  visit
  vlc
  xquartz
)

function log() {
  echo $* > /dev/stderr
}

log "brew update"
brew update

log "brew upgrade"
brew upgrade

log "tapping.."
for name in $taps
do
    log "brew tap ${name}"
    brew tap $name
done

log "installing XQuartz...required for some packages"
brew cask install xquartz

log "installing mactex...required for some packages"
brew cask install mactex

log "installing"
for name_and_args in $packages
do
    log "brew install ${=name_and_args}"
    brew install "${=name_and_args}"
done

for name_and_args in $cask_packages
do
    log "brew cask install ${=name_and_args}"
    brew cask install "${=name_and_args}"
done

log "brew cleanup"
brew cleanup

log "brew linkapps"
brew linkapps
